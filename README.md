# python-course-mipt-2025-year-5

приложение на fastapi для создания лабораторных экспериментов, их сопровождения и контроля 

# запуск
в makefile в корне проекта находятся скрипты для сетапа и запуска приложения.
| название цели makefile | назначение                                                                                                      |
| ---------------------- | --------------------------------------------------------------------------------------------------------------- |
| setup                  | подготовка окружения для локальной разработки - создание виртуального окружения и установка в него зависимостей |
| run                    | запуск приложения и базы данных с помощью docker compose, применение миграций                                   |
| run-local              | запуск приложения без базы данных, для локальной разработки                                                     |
| generate-secret        | генерация ключа шифрования                                                                                      |
| clean                  | очистка среды запуска - удаление контейнеров и вольюмов                                                         |
| lint                   | генерация pylint отчета                                                                                         |

для запуска:
- создать файлы `.env` и `postgres.env` с необходимыми переменными окружения в корне проекта
- `make generate-secret` - для генерации случайного ключа шифрования
- `make run` - для сборки и запуска
- перейти на адрес `0.0.0.0:<port>/docs` (по умолчанию порт 80)

# структура
- приложение на fastapi, база данных - postgres
- для связи с postgres используется асинхронный коннектор asyncpg с пулом из 4 соединений
- для генерации SQL-запросов используется query-builder pypika
- для миграций базы данных использованы bash-скрипты, .sql файлы и включенный по умолчанию режим запуска в контейнере postgres

# эндпоинты
- `/auth` - авторизация
  - `/signup` POST - создание аккаунта пользователя
  - `/login` POST
- `/experiment` - CRUD-операции с экспериментами
  - `/` GET - получить эксперименты с пагинацией
  - `/` POST - создать новый эксперимент; теги создаются автоматически
  - `/my` GET - получение экспериментов, в которых испольнитель - залогиненный пользователь; с пагинацией
  - `/{experiment_id}` GET - получить эксперимент по id
  - `/{experiment_id}` PATCH - изменение эксперимента
  - `/{experiment_id}` DELETE - удаление эксперимента; тэги автоматически отвязываются от удаленной записи
- `/tags` - фильтрация по тегам
  - `/` GET - получение списка тегов
  - `/{tag}` GET - получение экспериментов помеченных тегом; с пагинацией

# TODO
- [x] scripts
  - [x] setup
  - [x] local dev
  - [x] run in docker
  - [x] pylint
  - [x] clean
- [x] docker
- [x] the app:
  - [x] CRUD for experiments
  - [x] list & filter experiments
  - [x] auth
  - [x] tags?
- [x] database:
  - [x] structure
  - [x] migrations
- [x] this readme